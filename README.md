# 暗黑4助手 v6.0 使用说明书

## 📋 目录
- [程序简介](#程序简介)
- [主要功能](#主要功能)
- [界面介绍](#界面介绍)
- [功能详解](#功能详解)
- [配置指南](#配置指南)
- [使用技巧](#使用技巧)
- [常见问题](#常见问题)
- [注意事项](#注意事项)

---

## 🎮 程序简介

**暗黑4助手 v6.0** 是一款专为《暗黑破坏神4》设计的游戏辅助工具，基于AutoHotkey v2.0.19开发。该工具旨在减少重复性操作，提升游戏体验，支持技能自动释放、智能暂停检测、精造时机计算等多种功能。

### 系统要求
- 操作系统：Windows 10/11
- AutoHotkey：v2.0.19或更高版本
- 游戏：暗黑破坏神4

---

## ⚡ 主要功能

### 🎯 核心功能
- **技能自动释放**：支持5个技能位+左右键的自动释放
- **智能暂停系统**：根据游戏状态自动暂停/恢复宏操作
- **多运行模式**：多线程/单线程执行模式
- **精造时机计算**：精确计算装备精造最佳时机
- **配置管理**：支持多配置方案保存和切换

### 🔍 检测功能
- **血条检测**：自动检测怪物/Boss血条状态
- **界面检测**：识别TAB界面、对话框等状态
- **窗口检测**：仅在暗黑4窗口激活时运行
- **双击暂停**：双击鼠标左键临时暂停

### 🛠️ 辅助功能
- **鼠标自动移动**：罗盘专用
- **随机延迟**：增加操作随机性
- **强制移动**：自动执行强制移动操作
- **闪避辅助**：自动闪避功能

---

## 🖥️ 界面介绍

### 主界面布局

<img width="732" height="843" alt="wechat_2025-08-02_004503_994" src="https://github.com/user-attachments/assets/99e565f9-7090-4262-920e-c1f6a566bbb8" />

#### 启动热键区域（左上）
- **模式选择**：自定义/侧键1/侧键2
- **自定义热键**：当选择自定义模式时可设置热键
- **默认热键**：F1

#### 配置管理区域（右上）
- **配置下拉框**：选择不同的配置方案
- **保存按钮**：保存当前设置到选中方案
- **删除按钮**：删除选中的配置方案

#### 状态控制区域
- **状态显示**：显示当前运行状态
- **开始/停止按钮**：手动控制宏的启停
- **运行模式**：多线程/单线程选择
- **仅在暗黑4中使用**：限制宏仅在游戏窗口运行

### 标签页

#### 战斗模式标签页
包含所有技能设置、鼠标操作、辅助功能和暂停管理选项。

#### 工具模式标签页
包含精造模式和窗口置顶功能。

<img width="732" height="843" alt="wechat_2025-08-02_004510_837" src="https://github.com/user-attachments/assets/cd48b618-1d12-4dd0-bbb1-69a8ae1175de" />

---

## 🎮 功能详解

### 技能配置

#### 技能1-5配置
每个技能位支持以下设置：
- **按键**：设置对应的键位（1-5或自定义）
- **启用**：是否启用该技能的自动释放
- **间隔**：技能释放间隔时间（毫秒）
- **运行策略**：
  - **连点**：按设定间隔持续释放
  - **BUFF**：检测技能图标状态，仅在非激活时释放
  - **按住**：按下并保持按键状态
  - **资源**：检测资源条状态，仅在资源充足时释放

#### 鼠标按键配置
- **左键/右键**：支持与技能相同的运行策略
- **间隔设置**：左键默认80ms，右键默认300ms

#### 特殊功能键
- **药水（Q键）**：自动使用治疗药水，默认间隔3秒
- **强移（E键）**：强制移动功能，默认间隔50ms
- **闪避（空格）**：自动闪避功能，默认间隔20ms

### 启停管理

#### 双击暂停
- **功能**：双击鼠标左键临时暂停宏运行
- **持续时间**：可设置1-3秒的暂停时间
- **应用场景**：需要精确操作时临时停止自动化

#### 血条检测
- **怪物血条**：检测屏幕上方怪物血条
- **Boss血条**：检测Boss血条显示
- **检测间隔**：默认50ms，可调整10-1000ms
- **逻辑**：有血条时继续运行，无血条时自动暂停

#### 界面检测
- **TAB界面**：检测库存、技能树等界面
- **对话框**：检测NPC对话、系统提示等
- **检测间隔**：默认50ms，可调整10-1000ms
- **逻辑**：检测到界面打开时自动暂停

#### 偏移设置
- **X/Y偏移**：微调检测坐标位置
- **范围**：-3到+3像素
- **用途**：适配不同分辨率或显示设置

### 辅助功能

#### 按住Shift
- **功能**：在所有按键操作时自动按住Shift键
- **用途**：站立施法、精确移动等

#### 随机延迟
- **功能**：在设定间隔基础上增加随机延迟
- **范围**：1-10毫秒随机值
- **用途**：增加操作的随机性，避免被检测

#### 鼠标自移
- **功能**：定期移动鼠标到屏幕不同位置
- **间隔**：默认1000ms
- **移动点**：屏幕6个固定位置循环
- **用途**：防止挂机检测

### 精造模式

#### 基础设置
- **精造模式**：暗金（4阶段）/传奇（5阶段）
- **窗口周期**：每个精造阶段的时间长度（毫秒）
- **偏差修正**：补偿操作延迟的时间值

#### 操作流程
1. **开始**：记录开始时间，执行前4次点击
2. **继续**：计算最佳时机，执行精确点击
3. **重置**：清空记录数据，重新开始

#### 计算原理
- 基于周期性时间窗口计算最佳点击时机
- 考虑操作延迟和系统响应时间
- 支持词条命中率统计和偏差分析

---

## ⚙️ 配置指南

### 快速设置

#### 新手推荐配置
1. **技能设置**：启用主要输出技能（如技能1、2）
2. **间隔设置**：
   - 主动技能：100-300ms
   - 被动技能：1000-3000ms
   - 鼠标右键：300-500ms
3. **暂停检测**：启用血条检测和界面检测
4. **运行模式**：选择多线程模式

#### 高级用户配置
1. **精确间隔调整**：根据技能CD和资源消耗优化
2. **BUFF模式**：为长CD技能启用BUFF检测
3. **资源模式**：为高耗能技能启用资源检测
4. **随机延迟**：启用随机延迟增加真实感

### 配置方案管理

#### 创建配置
1. 在配置下拉框中输入新方案名称
2. 调整各项设置到满意状态
3. 点击"保存"按钮保存配置

#### 切换配置
1. 从配置下拉框选择目标方案
2. 系统自动加载对应设置
3. 上次使用的方案会在重启时自动加载

#### 删除配置
1. 选择要删除的配置方案
2. 点击"删除"按钮确认删除
3. 默认配置无法删除，删除后重置为默认设置

---

## 💡 使用技巧

### 性能优化

#### 检测间隔优化
- **血条检测**：根据战斗频率调整，高频战斗可设为30ms
- **界面检测**：可适当调大到100ms以减少CPU占用
- **随机延迟**：设置为3-5ms即可，过大影响响应

#### 运行模式选择
- **多线程模式**：适合多技能同时使用的场景
- **单线程模式**：适合需要精确控制顺序的场景

### 实用设置

#### 职业专用配置
- **野蛮人**：重点配置怒吼、旋风斩等技能
- **法师**：设置传送、护盾等防护技能
- **盗贼**：配置闪避、隐身等机动技能
- **圣教军**：设置光环、治疗等辅助技能
- **死灵法师**：配置召唤、诅咒等技能

#### 场景专用设置
- **刷怪场景**：启用血条检测，调高技能释放频率
- **Boss战**：启用所有检测，设置保守的技能间隔
- **安全地区**：可关闭大部分自动化功能

---

## ❓ 常见问题

### 功能问题

#### Q：程序无法启动或报错
**A：** 
1. 确认安装了AutoHotkey v2.0.19或更高版本
2. 检查是否有杀毒软件阻止运行
3. 尝试以管理员权限运行

#### Q：热键无法生效
**A：**
1. 检查热键是否与其他程序冲突
2. 确认暗黑4窗口处于激活状态
3. 尝试更换其他热键

#### Q：技能无法正确释放
**A：**
1. 检查游戏内按键绑定是否匹配
2. 确认技能间隔设置是否合理
3. 验证"仅在暗黑4中使用"选项设置

### 检测问题

#### Q：血条检测不准确
**A：**
1. 调整偏移设置（X/Y坐标）
2. 检查游戏分辨率和界面缩放
3. 尝试调整检测间隔

#### Q：界面检测误触发
**A：**
1. 适当调大检测间隔
2. 检查是否有界面元素遮挡检测点
3. 确认游戏版本兼容性

### 性能问题

#### Q：程序占用CPU过高
**A：**
1. 调大各项检测间隔
2. 关闭不必要的检测功能
3. 选择单线程运行模式

#### Q：游戏出现卡顿
**A：**
1. 降低技能释放频率
2. 关闭随机延迟功能
3. 减少同时运行的技能数量

---

## ⚠️ 注意事项

### 使用规范

#### 合理使用
- 本工具仅用于减少重复性操作，不应用于完全自动化游戏
- 建议在合理范围内使用，避免影响游戏平衡
- 不建议在PVP或竞技模式中使用

#### 安全建议
- 定期关闭程序让角色休息
- 避免长时间连续使用
- 注意观察游戏内提示和警告

### 技术限制

#### 分辨率支持
- 程序基于3840x2160分辨率开发
- 其他分辨率可能需要调整偏移设置
- 建议使用全屏模式以获得最佳兼容性

#### 游戏版本
- 程序针对当前游戏版本开发
- 游戏更新可能影响检测准确性
- 如遇问题请检查是否有程序更新

### 法律声明

#### 免责声明
- 本程序仅供学习和研究用途
- 使用者需自行承担使用风险
- 开发者不对游戏账号安全负责

#### 版权信息
- 程序基于AutoHotkey开源许可
- 禁止用于商业用途
- 欢迎提供改进建议和反馈

---

## 📞 技术支持

### 获取帮助
- **GitHub仓库**：[D4keyHelp](https://github.com/Czerror/D4keyHelp)
- **问题反馈**：通过GitHub Discussions提交
- **功能建议**：欢迎提交Pull Request

### 版本信息
- **当前版本**：v6.0
- **开发者**：Archenemy
- **更新日期**：2025年8月2日
- **AutoHotkey版本**：v2.0.19

---

*最后更新：2025年8月2日*
